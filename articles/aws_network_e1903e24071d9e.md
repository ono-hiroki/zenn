---
title: "AWSã§VPCå†…ã«ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½œæˆã—ã¦ã¿ã‚ˆã†"
emoji: "ğŸŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["aws","terraform"]
published: true
---

# ä½œæˆã™ã‚‹æ§‹æˆ

æœ€çµ‚çš„ã«ä¸‹è¨˜ã®æ§‹æˆã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚[#æœ€çµ‚çš„ãªTerraformã®ãƒªã‚½ãƒ¼ã‚¹](#æœ€çµ‚çš„ãªterraformã®ãƒªã‚½ãƒ¼ã‚¹)ã§æœ€çµ‚çš„ãªTerraformã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¼‰ã›ã¦ã‚ã‚Šã¾ã™ã€‚

![image.png](/images/aws_network_intro/image.png)

# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®è¨€èªè¨­å®š

ã‚‚ã—ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®è¨€èªè¨­å®šãŒè‹±èªã«ãªã£ã¦ã„ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ—¥æœ¬èªã«å¤‰æ›´ã—ã¦ãŠãã¨è‰¯ã„ã§ã™ã€‚ä»–ã®è¨­å®šã¯ã€Œã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã‚’è¡¨ç¤ºã€ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™ã€‚

![image32.png](/images/aws_network_intro/image32.png)

# VPC

ã¾ãšã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ä¸Šã« 10.0.0.0/16 ã®VPCã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚
![image1.png](/images/aws_network_intro/image3.png)

## VPCã‚’ä½œæˆ

`10.0.0.0/16` ã§VPCã‚’ä½œæˆã—ã¾ã™ã€‚

- åå‰ã‚’ example-vpc
- IPv4 CIDR ã‚’ 10.0.0.0/16

![image2.png](/images/aws_network_intro/image2.png)

- terraformã§ä½œæˆã™ã‚‹å ´åˆã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

:::details ã‚¿ã‚¤ãƒˆãƒ«

```hcl
resource "aws_vpc" "example" {
  cidr_block = "10.0.0.0/16"
  tags = {
    Name = "example-vpc"
  }
}
```

:::

## ä½œæˆã—ãŸVPCã®ç¢ºèª

vpc > ãŠä½¿ã„ã®VPC ã‹ã‚‰ç¢ºèªã§ãã¾ã™ã€‚

ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã‚’è¦‹ã‚‹ã¨ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒï¼‘ã¤ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚Terraformã§æ„è­˜ã—ã¦ãªãã¦ã‚‚ã€AWSãŒå‹æ‰‹ã«ä½œæˆã—ã¦ã„ã‚‹ã®ã§ä¸€å¿œçŸ¥ã£ã¦ã„ã‚‹ã¨è‰¯ã„ã§ã™ã€‚

![image26.png](/images/aws_network_intro/image26.png)

å®Ÿéš›ã«ä½œæˆã•ã‚ŒãŸã®ã¯ã€ã“ã‚“ãªæ„Ÿã˜ã®æ§‹æˆå›³ã§ã™ã€‚æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸­ã«VPCã¨ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

![image3.png](/images/aws_network_intro/image3.png)

# ã‚µãƒ–ãƒãƒƒãƒˆ

æ¬¡ã¯ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½œã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã‚¢ãƒ™ã‚¤ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚¾ãƒ¼ãƒ³ã¯ ap-northeast-1a ã¨ ap-northeast-1c ã®2ã¤ã‚’ä½¿ã£ã¦ã„ãã¾ã™ã€‚

![image4.png](/images/aws_network_intro/image4.png)

## ã‚µãƒ–ãƒãƒƒãƒˆã®ä½œæˆ

4ã¤ã®ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚

![image5.png](/images/aws_network_intro/image5.png)
![image6.png](/images/aws_network_intro/image6.png)
![image7.png](/images/aws_network_intro/image7.png)

## ä½œæˆã—ãŸã‚µãƒ–ãƒãƒƒãƒˆã®ç¢ºèª

VPC > ã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ä½œæˆã—ãŸã‚µãƒ–ãƒãƒƒãƒˆã‚’ç¢ºèªã§ãã¾ã™ã€‚

![image8.png](/images/aws_network_intro/image8.png)

VPC > ãŠä½¿ã„ã®VPC ã‹ã‚‰ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã‚’ç¢ºèªã—ã¾ã™ã€‚

å‹æ‰‹ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ä½œæˆã—ãŸã‚µãƒ–ãƒãƒƒãƒˆãŒç´ã¥ã„ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![image9.png](/images/aws_network_intro/image9.png)

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤

ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½œæˆã—ã¾ã—ãŸãŒã€ã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å‡ºã‚‹ã«ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ãŒå¿…è¦ã§ã™ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

![image10.png](/images/aws_network_intro/image10.png)

## ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®ä½œæˆ

ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½œæˆã—ã¾ã™ã€‚
![image11.png](/images/aws_network_intro/image11.png)

ä½œæˆã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’è¦‹ã‚‹ã¨çŠ¶æ…‹ãŒãƒ‡ã‚¿ãƒƒãƒã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
ã¾ãŸã€VPCã®ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã‚’è¦‹ã‚‹ã¨ã€ã¾ã ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã“ã“ã«è¡¨ç¤ºã•ã›ã‚‹ã«ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’VPCã«ã‚¢ã‚¿ãƒƒãƒå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![image27.png](/images/aws_network_intro/image27.png)
![image28.png](/images/aws_network_intro/image28.png)

## ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’VPCã«ã‚¢ã‚¿ãƒƒãƒ

ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’VPCã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã«ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’é¸æŠã—ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ > VPCã«ã‚¢ã‚¿ãƒƒãƒã‹ã‚‰ã§ãã¾ã™ã€‚

![image12.png](/images/aws_network_intro/image12.png)

ã‚¢ã‚¿ãƒƒãƒã—ãŸã„VPCã‚’é¸æŠã—ã¦ã€VPCã‚’ã‚¢ã‚¿ãƒƒãƒã—ã¾ã™ã€‚

![image13.png](/images/aws_network_intro/image13.png)

## ä½œæˆã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®ç¢ºèª

ä½œæˆã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’è¦‹ã¦ã¿ã‚‹ã¨ çŠ¶æ…‹ãŒ Attached ã«ãªã£ã¦ã„ã‚Œã°OKã§ã™ã€‚

![image14.png](/images/aws_network_intro/image14.png)
VPCã®ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã®ã»ã†ã‚‚è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®éƒ¨åˆ†ã« example-igw ãŒç„¡äº‹è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚

![image15.png](/images/aws_network_intro/image15.png)
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½œæˆã—ã¦VPCã«ã‚¢ã‚¿ãƒƒãƒã‚’ã—ã¾ã—ãŸãŒã€ã“ã®ã¾ã¾ã§ã¯ã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ã§ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚’ç´ã¥ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ¬¡ã¯ã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

# ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«

ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€ã‚µãƒ–ãƒãƒƒãƒˆã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ç´ã¥ã‘ã¦ã„ãã¾ã™ã€‚

![image16.png](/images/aws_network_intro/image16.png)

## ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

ãƒ‘ãƒ–ãƒªãƒƒã‚¯ç”¨ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆç”¨ã®ï¼’ã¤ã®ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

![image17.png](/images/aws_network_intro/image17.png)
![image18.png](/images/aws_network_intro/image18.png)

## ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚µãƒ–ãƒãƒƒãƒˆã®é–¢é€£ä»˜ã‘

VPCã®ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã‚’è¦‹ã‚‹ã¨ã€ã™ã¹ã¦ã®ã‚µãƒ–ãƒãƒƒãƒˆãŒãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
![image19.png](/images/aws_network_intro/image19.png)

ã‚µãƒ–ãƒãƒƒãƒˆãŒãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯ ã€æ˜ç¤ºçš„ã«ã‚µãƒ–ãƒãƒƒãƒˆã®é–¢é€£ä»˜ã‘ã‚’ã—ã¦ã„ãªã„å ´åˆã€ãƒ¡ã‚¤ãƒ³ã®ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«é–¢é€£ä»˜ã‘ãŒã•ã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚
![image29.png](/images/aws_network_intro/image29.png)

æ¬¡ã¯ã€æ˜ç¤ºçš„ã«ã«ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®é–¢é€£ä»˜ã‘ã‚’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ ã‚µãƒ–ãƒãƒƒãƒˆã®é–¢é€£ä»˜ã‘ã¯ ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ >
ã‚µãƒ–ãƒãƒƒãƒˆã®é–¢é€£ä»˜ã‘ã‚’ç·¨é›†ã€ ã‹ã‚‰ã§ãã¾ã™ã€‚
![image20.png](/images/aws_network_intro/image20.png)

é–¢é€£ä»˜ã‘ã—ãŸã„ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã‚’é¸æŠã—ã€ã€Œé–¢é€£ä»˜ã‘ã‚’ä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚åŒæ§˜ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‚‚é–¢é€£ä»˜ã‘ã•ã›ã¾ã™ã€‚

![image21.png](/images/aws_network_intro/image21.png)

ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®è©³ç´°ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã€ã€Œæ˜ç¤ºçš„ãªã‚µãƒ–ãƒãƒƒãƒˆã®é–¢é€£ä»˜ã‘ã€ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆãŒé–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

![image30.png](/images/aws_network_intro/image30.png)

ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã‚’è¦‹ã‚‹ã¨ã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚µãƒ–ãƒãƒƒãƒˆãŒé–¢é€£ä»˜ã„ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ãŸã ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ãªã„ãŸã‚ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ã§ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã¯ã“ã‚Œã§OKã§ã™ã€‚æ¬¡ã¯ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨é–¢é€£ä»˜ã‘ã•ã›ã¾ã—ã‚‡ã†ã€‚

![image22.png](/images/aws_network_intro/image22.png)

## ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®é–¢é€£ä»˜ã‘

ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å‡ºã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨é–¢é€£ä»˜ã‘ã•ã›ã¦ã„ãã¾ã™ã€‚é–¢é€£ä»˜ã‘ã‚’ã™ã‚‹ãŸã‚ã«ã¯ã€
ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã— ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ > ãƒ«ãƒ¼ãƒˆã‚’ç·¨é›†ã€ã‹ã‚‰ã§ãã¾ã™ã€‚

![image23.png](/images/aws_network_intro/image23.png)

0.0.0.0/0 ã«ã™ã‚‹ã“ã¨ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆå†…ã®ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒã™ã¹ã¦ã®å®›å…ˆã¸ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨ã®é–¢é€£ä»˜ã‘ã®è¨­å®šã‚’ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ãŒã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®é•ã„ã«ãªã‚Šã¾ã™ã€‚

![image24.png](/images/aws_network_intro/image24.png)

## ä½œæˆã—ãŸãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¢ºèª

VPCã®ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ã‚’è¦‹ã‚‹ã¨ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¯ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚ˆã£ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã¯ä½œæˆã—ãŸãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆç”¨ã®ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

![image25.png](/images/aws_network_intro/image25.png)

ã“ã‚Œã«ã¦ã€åŸºæœ¬çš„ãªãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®ä½œæˆã¯çµ‚äº†ã§ã™ã€‚

# ã¾ã¨ã‚

ä»Šå›ã¯ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½œæˆã—ã¦ã„ãã¾ã—ãŸã€‚æ€ã£ãŸã‚ˆã‚Šã‚„ã‚‹ã“ã¨ãŒå¤šã„ãªã¨æ€ã£ãŸã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿç§ã¯åˆã‚ã¦ã‚„ã£ãŸã¨ãã¯æ€ã„ã¾ã—ãŸğŸ¥º

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã“ã¨ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚

- NATã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½œæˆã—ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å‡ºã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
- ã‚µãƒ–ãƒãƒƒãƒˆå†…ã«é©å½“ãªEC2ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å‡ºã‚Œã‚‹ã‹ç¢ºèªã™ã‚‹
- EC2ã‚’ä½œæˆã—ã¦ã€System Managerã‚’ä½¿ã£ã¦SSHæ¥ç¶šã›ãšã«EC2ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
- ECSã‚’ä½œæˆã—ã¦ã€ECSã®ã‚¿ã‚¹ã‚¯ã‚’èµ·å‹•ã™ã‚‹

# æœ€çµ‚çš„ãªTerraformã®ãƒªã‚½ãƒ¼ã‚¹

```hcl
terraform {
  required_version = "~> 1.10"

  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "5.78.0"
    }
  }
}

provider "aws" {
  region = "ap-northeast-1"
}

resource "aws_vpc" "main" {
  cidr_block = "10.0.0.0/16"
  tags = {
    Name = "my-example-vpc"
  }
}

resource "aws_subnet" "public_a" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.1.0/24"
  availability_zone = "ap-northeast-1a"

  tags = {
    Name = "Public Subnet A"
  }
}

resource "aws_subnet" "public_c" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.2.0/24"
  availability_zone = "ap-northeast-1c"

  tags = {
    Name = "Public Subnet C"
  }
}

# ã‚µãƒ–ãƒãƒƒãƒˆã®ä½œæˆ
resource "aws_subnet" "private_a" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.11.0/24"
  availability_zone = "ap-northeast-1a"

  tags = {
    Name = "Private Subnet A"
  }
}

resource "aws_subnet" "private_c" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.12.0/24"
  availability_zone = "ap-northeast-1c"

  tags = {
    Name = "Private Subnet C"
  }
}

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®ä½œæˆ
resource "aws_internet_gateway" "main" {
  vpc_id = aws_vpc.main.id

  tags = {
    Name = "example-igw"
  }
}

# ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
resource "aws_route_table" "public" {
  vpc_id = aws_vpc.main.id

  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.main.id
  }

  tags = {
    Name = "public-rtb"
  }
}

resource "aws_route_table" "private" {
  vpc_id = aws_vpc.main.id

  route = []

  tags = {
    Name = "private-rtb"
  }
}

# ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®é–¢é€£ä»˜ã‘
resource "aws_route_table_association" "public_a" {
  subnet_id      = aws_subnet.public_a.id
  route_table_id = aws_route_table.public.id
}
resource "aws_route_table_association" "private_a" {
  subnet_id      = aws_subnet.private_a.id
  route_table_id = aws_route_table.private.id
}
resource "aws_route_table_association" "public_c" {
  subnet_id      = aws_subnet.public_c.id
  route_table_id = aws_route_table.public.id
}
resource "aws_route_table_association" "private_c" {
  subnet_id      = aws_subnet.private_c.id
  route_table_id = aws_route_table.private.id
}
```
